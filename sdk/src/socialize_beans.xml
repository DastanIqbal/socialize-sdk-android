<beans>
	
	<bean id="classLoaderProvider" class="com.socialize.util.ClassLoaderProvider"/>

	<bean id="resourceLocator" class="com.socialize.util.ResourceLocator">
		<property name="classLoaderProvider" ref="classLoaderProvider"/>
		<property name="logger" ref="logger"/>
	</bean>
	
	<bean id="config" class="com.socialize.config.SocializeConfig">
		<init-method name="init">
			<arg type="context"/>
		</init-method>
		<property name="logger" ref="logger"/>
		<property name="resourceLocator" ref="resourceLocator"/>
	</bean>
	
	<bean id="logger" class="com.socialize.log.SocializeLogger">
		<init-method name="init">
			<arg ref="config"/>
		</init-method>
	</bean>
	
	<bean id="deviceUtils" class="com.socialize.util.DeviceUtils">
		<property name="logger" ref="logger"/>
		<init-method name="init">
			<arg type="context"/>
		</init-method>
	</bean>
	
	<bean id="base64Utils" class="com.socialize.util.Base64Utils"/>
	
	<bean id="httpUtils" class="com.socialize.util.HttpUtils">
		<init-method name="init">
			<arg type="context"/>
		</init-method>
		<property name="resourceLocator" ref="resourceLocator"/>
		<property name="logger" ref="logger"/>
	</bean>
	
	<bean id="locationManager" class="com.socialize.location.SocializeLocationManager">
		<constructor-arg ref="deviceUtils"/>
		<init-method name="init">
			<arg type="context"/>
		</init-method>
	</bean>
	
	<bean id="locationProvider" class="com.socialize.location.DefaultLocationProvider">
		<constructor-arg type="activity"/>
		<property name="deviceUtils" ref="deviceUtils"/>
		<property name="locationManager" ref="locationManager"/>
		<property name="locationListenerFactory" ref="locationListenerFactory"/>
		
		<init-method name="init"/>
	</bean>
	
	<bean id="locationListener" class="com.socialize.location.SocializeLocationListener" singleton="false">
		<property name="locationProvider" ref="locationProvider"/>
	</bean>
	
	<bean id="initializationAsserter" class="com.socialize.init.DefaultInitializationAsserter">
		<property name="logger" ref="logger"/>
	</bean>
	
	<factory id="locationListenerFactory" makes="locationListener"/>
	
	<bean id="ioUtils" class="com.socialize.util.IOUtils">
		<property name="logger" ref="logger"/>
	</bean>
	
	<bean id="jsonParser" class="com.socialize.util.JSONParser">
		<property name="ioUtils" ref="ioUtils"/>
	</bean>
	
	<bean id="authProviderData" class="com.socialize.auth.AuthProviderData" singleton="false"/>
	
	<factory id="authProviderDataFactory" makes="authProviderData"/>	
	
	<bean id="cache" class="com.socialize.util.DrawableCache">
		<constructor-arg type="context"/>
		<constructor-arg type="integer" value="10"/> <!-- Min size -->
		<constructor-arg type="integer" value="100"/> <!-- Max size -->
		<destroy-method name="destroy"/>
	</bean>
	
	<bean id="bitmapBuilder" class="com.socialize.util.BitmapBuilder"/>
	
	<bean id="bitmapUtils" class="com.socialize.util.BitmapUtils">
		<property name="bitmapBuilder" ref="bitmapBuilder"/>
		<property name="base64Utils" ref="base64Utils"/>
	</bean>
	
	<bean id="drawables" class="com.socialize.util.Drawables">
		<constructor-arg type="activity"/>
		<property name="classLoaderProvider" ref="classLoaderProvider"/>
		<property name="cache" ref="cache"/>
		<property name="logger" ref="logger"/>
		<property name="bitmapUtils" ref="bitmapUtils"/>
	</bean>
	
	<bean id="dialogFactory" class="com.socialize.util.DialogFactory"/>
	<bean id="userAuthDataFactory" class="com.socialize.entity.factory.UserAuthDataFactory"/>
	<bean id="statsFactory" class="com.socialize.entity.factory.StatsFactory"/>
	
	<bean id="userFactory" class="com.socialize.entity.factory.UserFactory">
		<property name="statsFactory" ref="statsFactory"/>
		<property name="userAuthDataFactory" ref="userAuthDataFactory"/>
	</bean>

	<bean id="applicationFactory" class="com.socialize.entity.factory.ApplicationFactory"/>
	
	<bean id="responseFactory" class="com.socialize.api.DefaultSocializeResponseFactory"/>
	
	<bean id="errorFactory" class="com.socialize.entity.factory.ErrorFactory"/>
	
	<bean id="clientFactory" class="com.socialize.net.DefaultHttpClientFactory">
		<init-method name="init">
			<arg ref="config"/>
		</init-method>
		<destroy-method name="destroy"/>
		<property name="logger" ref="logger"/>
	</bean>
	
	<bean id="sessionFactory" class="com.socialize.api.DefaultSocializeSessionFactory">
		<constructor-arg ref="config"/>
		<constructor-arg ref="authProviders"/>
	</bean>
	
	<bean id="sessionPersister" class="com.socialize.api.PreferenceSessionPersister">
		<constructor-arg ref="userFactory"/>
		<constructor-arg ref="sessionFactory"/>
	</bean>
	
	<bean id="abstractProvider" class="com.socialize.provider.DefaultSocializeProvider" abstract="true">
		<constructor-arg type="context"/>
		
		<init-method name="init"/>
		
		<property name="logger" ref="logger"/>
		<property name="authProviderDataFactory" ref="authProviderDataFactory"/>
		<property name="userFactory" ref="userFactory"/>
		<property name="clientFactory" ref="clientFactory"/>
		<property name="sessionFactory" ref="sessionFactory"/>
		<property name="errorFactory" ref="errorFactory"/>
		<property name="config" ref="config"/>
		<property name="jsonParser" ref="jsonParser"/>
		<property name="httpUtils" ref="httpUtils"/>
		<property name="ioUtils" ref="ioUtils"/>
		<property name="sessionPersister" ref="sessionPersister"/>
		<property name="facebookSessionStore" ref="facebookSessionStore"/>
		
	</bean>
	
	<bean id="authProviders" class="com.socialize.auth.AuthProviders">
		<property name="providers">
			<map>
				<entry>
					<key value="1" type="integer"/>
					<value ref="facebookProvider"/>
				</entry>
			</map>
		</property>
	</bean>
	
<!-- 
	Facebook 
-->
	<bean id="facebookSessionStore" class="com.socialize.auth.facebook.FacebookSessionStore"/>
	
	<bean id="facebookUrlBuilder" class="com.socialize.auth.facebook.FacebookUrlBuilder"/>
	 
	<bean id="listenerHolder" class="com.socialize.listener.ListenerHolder"/>
	
	<bean id="facebookProvider" class="com.socialize.auth.facebook.FacebookAuthProvider">
		<constructor-arg type="context"/>
		<constructor-arg ref="listenerHolder"/>
		<property name="logger" ref="logger"/>
		<property name="drawables" ref="drawables"/>
	</bean>
	
	<bean id="socializeApi" class="com.socialize.api.SocializeApi" abstract="true">
		<property name="responseFactory" ref="responseFactory"/>
		<property name="authProviderDataFactory" ref="authProviderDataFactory"/>
		<property name="config" ref="config"/>
		<property name="logger" ref="logger"/>
		<property name="authProviders" ref="authProviders"/>
		<property name="httpUtils" ref="httpUtils"/>
		<property name="locationProvider" ref="locationProvider"/>
	</bean>
	
	<bean id="socializeActionFactory" class="com.socialize.entity.factory.SocializeActionFactory" abstract="true">
		<property name="logger" ref="logger"/>
		<property name="applicationFactory" ref="applicationFactory"/>
		<property name="userFactory" ref="userFactory"/>
		<property name="entityFactory" ref="entityFactory"/>
	</bean>
	
	<bean 
		id="facebook" 
		class="com.socialize.facebook.Facebook"
		singleton="false">
		<constructor-arg ref="drawables"/>
	</bean>
	
	
<!-- OAUTH -->
	
	<bean id="oauthConsumerFactory" class="com.socialize.oauth.CommonsHttpOAuthConsumerFactory"/>
	<bean id="oauthSigningStrategy" class="oauth.signpost.signature.AuthorizationHeaderSigningStrategy"/>
	<bean id="oauthSigner" class="com.socialize.oauth.DefaultOauthRequestSigner">
		<constructor-arg ref="oauthConsumerFactory"/>
		<constructor-arg ref="oauthSigningStrategy"/>
		<property name="deviceUtils" ref="deviceUtils"/>
	</bean>
	
<!-- END OAUTH -->

<!-- Comment API -->

	<bean id="commentFactory" class="com.socialize.entity.factory.CommentFactory" extends="socializeActionFactory"/>
	
	<bean id="commentRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="commentFactory"/>
	</bean>

	<bean id="commentProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="commentFactory"/>
		<property name="requestFactory" ref="commentRequestFactory"/>
	</bean>
	
	<bean id="commentApi" class="com.socialize.api.action.CommentApi" extends="socializeApi">
		<constructor-arg ref="commentProvider"/>
	</bean>

	
<!-- End Comment API -->	


<!-- Entity API -->

	<bean id="entityFactory" class="com.socialize.entity.factory.EntityFactory"/>
	
	<bean id="entityRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="entityFactory"/>
	</bean>

	<bean id="entityProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="entityFactory"/>
		<property name="requestFactory" ref="entityRequestFactory"/>
	</bean>
	
	<bean id="entityApi" class="com.socialize.api.action.EntityApi" extends="socializeApi">
		<constructor-arg ref="entityProvider"/>
	</bean>

<!-- End Entity API -->

<!-- Like API -->

	<bean id="likeFactory" class="com.socialize.entity.factory.LikeFactory" extends="socializeActionFactory"/>
	
	<bean id="likeRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="likeFactory"/>
	</bean>

	<bean id="likeProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="likeFactory"/>
		<property name="requestFactory" ref="likeRequestFactory"/>
	</bean>
	
	<bean id="likeApi" class="com.socialize.api.action.LikeApi" extends="socializeApi">
		<constructor-arg ref="likeProvider"/>
	</bean>
	
<!-- End Like API -->	

<!-- View API -->

	<bean id="viewFactory" class="com.socialize.entity.factory.ViewFactory" extends="socializeActionFactory"/>
	
	<bean id="viewRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="viewFactory"/>
	</bean>

	<bean id="viewProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="viewFactory"/>
		<property name="requestFactory" ref="viewRequestFactory"/>
	</bean>
	
	<bean id="viewApi" class="com.socialize.api.action.ViewApi" extends="socializeApi">
		<constructor-arg ref="viewProvider"/>
	</bean>
	
<!-- End View API -->

<!-- Share API -->

	<bean id="shareFactory" class="com.socialize.entity.factory.ShareFactory" extends="socializeActionFactory"/>
	
	<bean id="shareRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="shareFactory"/>
	</bean>

	<bean id="shareProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="shareFactory"/>
		<property name="requestFactory" ref="shareRequestFactory"/>
	</bean>
	
	<bean id="shareApi" class="com.socialize.api.action.ShareApi" extends="socializeApi">
		<constructor-arg ref="shareProvider"/>
	</bean>
	
<!-- End Share API -->

<!-- User API -->

	<bean id="userRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="userFactory"/>
	</bean>

	<bean id="userProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="userFactory"/>
		<property name="requestFactory" ref="userRequestFactory"/>
	</bean>
	
	<bean id="userApi" class="com.socialize.api.action.UserApi" extends="socializeApi">
		<constructor-arg ref="userProvider"/>
		<property name="sessionPersister" ref="sessionPersister"/>
	</bean>
	
<!-- End User API -->

<!-- Activity API -->

	<bean 
		id="activityFactory" 
		class="com.socialize.entity.factory.GenericActionFactory" 
		extends="socializeActionFactory">
		
		<property name="logger" ref="logger"/>
		<property name="commentFactory" ref="commentFactory"/>
		<property name="likeFactory" ref="likeFactory"/>
		<property name="viewFactory" ref="viewFactory"/>
		<property name="shareFactory" ref="shareFactory"/>
		
	</bean>
	
	<bean id="activityRequestFactory" class="com.socialize.api.DefaultSocializeRequestFactory">
		<constructor-arg ref="oauthSigner"/>
		<constructor-arg ref="activityFactory"/>
	</bean>

	<bean id="activityProvider" extends="abstractProvider">
		<constructor-arg type="context"/>
		<property name="objectFactory" ref="activityFactory"/>
		<property name="requestFactory" ref="activityRequestFactory"/>
	</bean>
	
	<bean id="activityApi" class="com.socialize.api.action.ActivityApi" extends="socializeApi">
		<constructor-arg ref="activityProvider"/>
	</bean>
	

<!-- End Activity API -->

<!-- Recommendation API -->

	<bean id="recommendationApi" class="com.socialize.api.action.RecommendationApi" extends="socializeApi">
		<constructor-arg ref="entityProvider"/>
	</bean>

<!-- End Recommendation API -->

<!-- Socialize Core -->

	<bean id="socializeApiHost" class="com.socialize.api.SocializeApiHost">
		<constructor-arg type="context"/>
		<property name="clientFactory" ref="clientFactory"/>
		<property name="authProviderDataFactory" ref="authProviderDataFactory"/>
		<property name="deviceUtils" ref="deviceUtils"/>
		<property name="commentApi" ref="commentApi"/>
		<property name="entityApi" ref="entityApi"/>
		<property name="likeApi" ref="likeApi"/>
		<property name="viewApi" ref="viewApi"/>
		<property name="userApi" ref="userApi"/>
		<property name="shareApi" ref="shareApi"/>
		<property name="activityApi" ref="activityApi"/>
		<property name="recommendationApi" ref="recommendationApi"/>
	</bean>
	
<!-- End Socialize Core -->

</beans>